<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.74.3 with theme Tranquilpeak 0.4.7-BETA">
<meta name="author" content="Giuliano Sposito">
<meta name="keywords" content="">
<meta name="description" content="










Usually Yann LeCun’s MNIST database is used to explore Artificial Neural Network architectures for image recognition problem.
In the last post the use of a ANN (LeNet architecture) implemented using mxnet to resolve this classification problem.
But in this post, we’ll see that the MNIST problem isn’t a difficult one, only resolved by ANNs, analyzing the data set we can see that is possible, with a high degree of precision, resolving this classification problem with a simple k-nearest neighbors algorithm.
">


<meta property="og:description" content="










Usually Yann LeCun’s MNIST database is used to explore Artificial Neural Network architectures for image recognition problem.
In the last post the use of a ANN (LeNet architecture) implemented using mxnet to resolve this classification problem.
But in this post, we’ll see that the MNIST problem isn’t a difficult one, only resolved by ANNs, analyzing the data set we can see that is possible, with a high degree of precision, resolving this classification problem with a simple k-nearest neighbors algorithm.
">
<meta property="og:type" content="article">
<meta property="og:title" content="kNN Analysis on MNIST with 97% accuracy">
<meta name="twitter:title" content="kNN Analysis on MNIST with 97% accuracy">
<meta property="og:url" content="/2018/01/knn-analysis-on-mnist-with-97-accuracy/">
<meta property="twitter:url" content="/2018/01/knn-analysis-on-mnist-with-97-accuracy/">
<meta property="og:site_name" content="Yet Another Iteration">
<meta property="og:description" content="










Usually Yann LeCun’s MNIST database is used to explore Artificial Neural Network architectures for image recognition problem.
In the last post the use of a ANN (LeNet architecture) implemented using mxnet to resolve this classification problem.
But in this post, we’ll see that the MNIST problem isn’t a difficult one, only resolved by ANNs, analyzing the data set we can see that is possible, with a high degree of precision, resolving this classification problem with a simple k-nearest neighbors algorithm.
">
<meta name="twitter:description" content="










Usually Yann LeCun’s MNIST database is used to explore Artificial Neural Network architectures for image recognition problem.
In the last post the use of a ANN (LeNet architecture) implemented using mxnet to resolve this classification problem.
But in this post, we’ll see that the MNIST problem isn’t a difficult one, only resolved by ANNs, analyzing the data set we can see that is possible, with a high degree of precision, resolving this classification problem with a simple k-nearest neighbors algorithm.
">
<meta property="og:locale" content="en-us">

  
    <meta property="article:published_time" content="2018-01-24T00:00:00">
  
  
    <meta property="article:modified_time" content="2018-01-24T00:00:00">
  
  
  
    
      <meta property="article:section" content="data science">
    
  
  
    
      <meta property="article:tag" content="en-US">
    
      <meta property="article:tag" content="evalutation">
    
      <meta property="article:tag" content="knn">
    
      <meta property="article:tag" content="machine learning">
    
      <meta property="article:tag" content="mnist">
    
      <meta property="article:tag" content="pca">
    
  


<meta name="twitter:card" content="summary">

  <meta name="twitter:site" content="@gsposito">


  <meta name="twitter:creator" content="@gsposito">






  <meta property="og:image" content="/images/mnist_knn_tn.png">
  <meta property="twitter:image" content="/images/mnist_knn_tn.png">





  <meta property="og:image" content="https://www.gravatar.com/avatar/2adfb1930aa9591ea756b0d94ca3603b?s=640">
  <meta property="twitter:image" content="https://www.gravatar.com/avatar/2adfb1930aa9591ea756b0d94ca3603b?s=640">


    <title>kNN Analysis on MNIST with 97% accuracy</title>

    <link rel="icon" href="/favicon.png">
    

    
      <link rel="publisher" href="https://plus.google.com/&#43;giulianosposito">
    

    <link rel="canonical" href="/2018/01/knn-analysis-on-mnist-with-97-accuracy/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.css" integrity="sha256-vuXZ9LGmmwtjqFX1F+EKin1ThZMub58gKULUyf0qECk=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css" integrity="sha256-SEa4XYAHihTcEP1f5gARTB2K26Uk8PsndQYHQC1f4jU=" crossorigin="anonymous" />
    
    
    <link rel="stylesheet" href="/css/style-twzjdbqhmnnacqs0pwwdzcdbt8yhv8giawvjqjmyfoqnvazl0dalmnhdkvp7.min.css" />
    
    

    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-112393378-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="5">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="/">Yet Another Iteration</a>
  </div>
  
    
      <a class="header-right-picture "
         href="/#about">
    
    
    
      
        <img class="header-picture" src="https://www.gravatar.com/avatar/2adfb1930aa9591ea756b0d94ca3603b?s=90" alt="Author&#39;s picture" />
      
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="5">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="/#about">
          <img class="sidebar-profile-picture" src="https://www.gravatar.com/avatar/2adfb1930aa9591ea756b0d94ca3603b?s=110" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Giuliano Sposito</h4>
        
          <h5 class="sidebar-profile-bio">Computer Engineer<!-- raw HTML omitted -->Masters in Tech Innovation Mgt<!-- raw HTML omitted -->Specialized in Data Science</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/categories">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/tags">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/about">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/giulsposito">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://twitter.com/gsposito">
    
      <i class="sidebar-button-icon fa fa-lg fa-twitter"></i>
      
      <span class="sidebar-button-desc">Twitter</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="5"
        class="
               hasCoverMetaIn
               ">
        <article class="post" itemscope itemType="http://schema.org/BlogPosting">
          
          
            <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title" itemprop="headline">
      kNN Analysis on MNIST with 97% accuracy
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time itemprop="datePublished" datetime="2018-01-24T00:00:00Z">
        
  January 24, 2018

      </time>
    
    
  
  
    <span>in</span>
    
      <a class="category-link" href="/categories/data-science">data science</a>
    
  

  </div>

</div>
          
          <div class="post-content markdown" itemprop="articleBody">
            <div class="main-content-wrap">
              <pre class="r"><code># setup
library(tidyverse)  # for plot and data manipulation
library(factoextra) # to plot PCA values
library(plotly)     # 3D interactive plots
library(class)      # KNN algorithm
library(caret)      # Near Zero Var removing</code></pre>
<div id="mnist-dataset" class="section level2">
<h2>MNist Dataset</h2>
<p>Download all four data set files from <a href="http://yann.lecun.com/exdb/mnist/">MNIST site</a> and gunzip them in the project directory.</p>
<p>The default MNIST data set is somewhat inconveniently formatted, but we use an adaptation of <a href="http://gist.github.com/39760">gist from Brendan o’Connor</a> to read the files transforming them in a structure simple to use and access.</p>
<pre class="r"><code>### load database

# read function returns a list of datasets
load_mnist &lt;- function() {
  load_image_file &lt;- function(filename) {
    ret = list()
    f = file(filename,&#39;rb&#39;)
    readBin(f,&#39;integer&#39;,n=1,size=4,endian=&#39;big&#39;)
    ret$n = readBin(f,&#39;integer&#39;,n=1,size=4,endian=&#39;big&#39;)
    nrow = readBin(f,&#39;integer&#39;,n=1,size=4,endian=&#39;big&#39;)
    ncol = readBin(f,&#39;integer&#39;,n=1,size=4,endian=&#39;big&#39;)
    x = readBin(f,&#39;integer&#39;,n=ret$n*nrow*ncol,size=1,signed=F)
    ret$x = matrix(x, ncol=nrow*ncol, byrow=T)
    close(f)
    ret
  }
  load_label_file &lt;- function(filename) {
    f = file(filename,&#39;rb&#39;)
    readBin(f,&#39;integer&#39;,n=1,size=4,endian=&#39;big&#39;)
    n = readBin(f,&#39;integer&#39;,n=1,size=4,endian=&#39;big&#39;)
    y = readBin(f,&#39;integer&#39;,n=n,size=1,signed=F)
    close(f)
    y
  }
  train &lt;- load_image_file(&#39;./data/mnist/train-images.idx3-ubyte&#39;)
  test &lt;- load_image_file(&#39;./data/mnist/t10k-images.idx3-ubyte&#39;)
  
  train$y &lt;- load_label_file(&#39;./data/mnist/train-labels.idx1-ubyte&#39;)
  test$y &lt;- load_label_file(&#39;./data/mnist/t10k-labels.idx1-ubyte&#39;)  
  
  return(
    list(
      train = train,
      test = test
    )
  )
}

# load in &#39;mnist&#39; var
mnist &lt;- load_mnist()

# look the data format
str(mnist)</code></pre>
<pre><code>## List of 2
##  $ train:List of 3
##   ..$ n: int 60000
##   ..$ x: int [1:60000, 1:784] 0 0 0 0 0 0 0 0 0 0 ...
##   ..$ y: int [1:60000] 5 0 4 1 9 2 1 3 1 4 ...
##  $ test :List of 3
##   ..$ n: int 10000
##   ..$ x: int [1:10000, 1:784] 0 0 0 0 0 0 0 0 0 0 ...
##   ..$ y: int [1:10000] 7 2 1 0 4 1 4 9 5 9 ...</code></pre>
<p>The gist read the binary MNIST files and returns a convenient list for training cases and test cases, each with size (n), the pixels (x) and the labels (y).</p>
<p>Let’s see some of the images represented in the <code>x</code> variable.</p>
<pre class="r"><code># functino plot one case digit (by 1d array of 784 pixels)
show_digit &lt;- function(arr784, col=gray(25:1/25), ...) {
  image(matrix(arr784, nrow=28)[,28:1], col=col, ...)
}

# showing first 25 cases
labels &lt;- paste(mnist$train$y[1:25],collapse = &quot;, &quot;)
par(mfrow=c(5,5), mar=c(0.1,0.1,0.1,0.1))
for(i in 1:25) show_digit(mnist$train$x[i,], axes=F)</code></pre>
<p><img src="/post/2018-01-24-knn-analysis-on-mnist-with-97-accuracy_files/figure-html/plotDatabase-1.png" width="672" /></p>
<p>Each line in <code>x</code> var is a digit case, and each column represents the intensity of a pixel in a <code>28 x 28</code> image.</p>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- knn-mnist-ad01 -->
<ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-5624634479725935" data-ad-slot="8848594632" data-ad-format="auto" data-full-width-responsive="true">
</ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div id="data-analysis" class="section level2">
<h2>Data Analysis</h2>
<p>How the each pixels in the image behavior in the “average” for each digit? It’s possible to use this information to classify an digit?</p>
<div id="centroid" class="section level3">
<h3>Centroid</h3>
<pre class="r"><code># calc digits centroids
centroids &lt;- list()
for(i in 0:9) {
  x &lt;- mnist$train$x[(mnist$train$y == i),]
  centroids[[i+1]] &lt;- colMeans(x) 
}

# ploting the centroids
par(mfrow=c(2,5), mar=c(0.1,0.1,0.1,0.1))
res &lt;- lapply(X = centroids, show_digit, xaxt=&#39;n&#39;, yaxt=&#39;n&#39;)</code></pre>
<p><img src="/post/2018-01-24-knn-analysis-on-mnist-with-97-accuracy_files/figure-html/calcCentroids-1.png" width="672" /></p>
<p>These averaged images are called centroids. We’re treating each image as a 784-dimensional point (28 by 28), and then taking the average of all points in each dimension individually.</p>
<p>We see that each centroid has a good representation of a digit, so each image in the data set are centralized in the image and there is not large variations. Maybe we can use one elementary machine learning method: <strong>nearest centroid classifier</strong>, would ask for each image which of these centroids it comes closest to.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
</div>
<div id="compare-centroids" class="section level3">
<h3>Compare Centroids</h3>
<p>How different one centroid is from other? We can simply take the difference between the pixel values for each digit pair like this:</p>
<pre class="r"><code># compare cases
compare &lt;- tidyr::crossing(comp1 = 0:9, comp2 = 0:9)

# calc features differences between the centroids
res &lt;- apply(compare, 1, function(x,m=centroids){
  unlist(m[x[1]+1]) - unlist(m[x[2]+1])
}) %&gt;% t() %&gt;% as_tibble()

centroids_diff &lt;- bind_cols(compare, res)

# plot them
par(mfrow=c(10,10), mar=c(0,0,0,0))
colFunc &lt;- colorRampPalette(c(&quot;red&quot;,&quot;white&quot;,&quot;blue&quot;))
res &lt;- sapply(1:100, FUN=function(x) show_digit(as.matrix(centroids_diff[x,3:786]),
                                                col=colFunc(35),
                                                axes=F))</code></pre>
<p><img src="/post/2018-01-24-knn-analysis-on-mnist-with-97-accuracy_files/figure-html/compCentroids-1.png" width="672" /></p>
<p>From the image we can see some “patterns” emerging from this. As higher are stains in this image more separable a digit from another is. We look particularly for <code>0</code> and <code>1</code> digits are strongly separable. But in fade images we have a problem, because the pixels are not ‘that’ different from one digit from other, like <code>4</code> x <code>9</code> and <code>3</code> x <code>8</code>.</p>
</div>
<div id="distance" class="section level3">
<h3>Distance</h3>
<p>We can “measure” this difference, taking each pixel as a dimensions in the digit represent space and apply a simple <em>euclidian distance</em> between these data.</p>
<pre class="r"><code># calculating the distance between the centroids in 786 dimensions
dist &lt;- apply(compare,1,function(x,m=centroids){
  sqrt(mean((unlist(m[x[1]+1])-unlist(m[x[2]+1]))^2))  
}) %&gt;% as_tibble()
centroids_dist &lt;- bind_cols(compare,dist)

# ploting the distances
ggplot(centroids_dist, aes(x=comp1, y=comp2, fill=value)) +
  geom_tile() + 
  geom_text(aes(label=round(value))) +
  scale_fill_gradient2(low = &quot;blue&quot;, high = &quot;red&quot;) +
  scale_x_continuous(breaks=0:9) + 
  scale_y_continuous(breaks=0:9) + 
  ylab(&quot;&quot;) + xlab(&quot;&quot;) + 
  theme_bw()</code></pre>
<p><img src="/post/2018-01-24-knn-analysis-on-mnist-with-97-accuracy_files/figure-html/distance-1.png" width="672" /></p>
<p>The distance here, measures the degree of “difference” between the centroids, and this matrix bring us a coll view, look at <code>0</code>x<code>1</code> how distance they are (69), making them easier to classify. Look at <code>4</code>x<code>9</code>, they are more next (23), let’s compare this with the <a href="https://en.wikipedia.org/wiki/Confusion_matrix">confusion matrix</a> generated by the LeNet ANN from the <a href="/2018/01/implementing-lenet-with-mxnet-in-r/">last post</a>:</p>
<pre><code>##           Reference
## Prediction    0    1    2    3    4    5    6    7    8    9
##          0  974    0    1    0    0    2    3    0    2    0
##          1    1 1131    0    0    0    0    2    2    0    0
##          2    0    0 1025    1    1    0    0    2    0    0
##          3    0    0    0 1000    0    5    1    1    1    2
##          4    0    0    1    0  970    0    0    1    0    6
##          5    1    0    0    6    0  878    4    0    2    2
##          6    3    2    1    0    1    2  947    0    0    1
##          7    1    0    2    0    0    0    0 1016    0    3
##          8    0    2    2    3    0    4    1    1  966    1
##          9    0    0    0    0   10    1    0    5    3  994</code></pre>
<p>We see the 16 mismatches involving cases <code>4</code>x<code>9</code>, the largest.</p>
<!-- knn-mnist-ad02 -->
<ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-5624634479725935" data-ad-slot="6953059034" data-ad-format="auto" data-full-width-responsive="true">
</ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
</div>
<div id="principal-component-analysis" class="section level2">
<h2>Principal Component Analysis</h2>
<p>We can improve this, it’s not all the pixels that have the same importance in the digit differentiation, some pixels (in the image borders, for example) don’t change its value along the data set and some pixels change very few from one digit to other. We transform the data sets to evidence the first removing the <em>zero variance</em> pixels and the second using <a href="https://en.wikipedia.org/wiki/Principal_component_analysis">Principal component Analysis</a> or PCA.</p>
<pre class="r"><code># transforming in a matrix
tr.x &lt;- mnist$train$x
ts.x &lt;- mnist$test$x
all.x &lt;- rbind(tr.x,ts.x)

# calculating the PCA

# removing zero or near zero variance features
nzv &lt;- nearZeroVar(all.x, saveMetrics = T)
all.x &lt;- all.x[,!nzv$zeroVar]

# principal component analysis
pca &lt;- prcomp(all.x, center = T)
saveRDS(pca, &quot;pca.rds&quot;) # store to save time in the future
print(paste0(&quot;Columns with zero variance: &quot;, sum(nzv$zeroVar)))</code></pre>
<pre><code>## [1] &quot;Columns with zero variance: 65&quot;</code></pre>
<div id="principal-componets" class="section level3">
<h3>Principal Componets</h3>
<p>This is the classic view of the first 10 principal components, they explain 49% of total variance of data set.</p>
<pre class="r"><code># principals component
fviz_eig(pca)</code></pre>
<p><img src="/post/2018-01-24-knn-analysis-on-mnist-with-97-accuracy_files/figure-html/principalComponents-1.png" width="672" /></p>
</div>
<div id="distribution-of-variance" class="section level3">
<h3>Distribution of variance</h3>
<p>Indeed, we see that the majority of the dimensions has near zero variance and few pixels explain a lot.</p>
<pre class="r"><code># rebuilding features (transformed)
tr.x &lt;- pca$x[(1:mnist$train$n),]
ts.x &lt;- pca$x[(mnist$train$n+1):(mnist$train$n+mnist$test$n),]

vars &lt;- apply(pca$x, 2, var)  
props &lt;- vars / sum(vars)

# distribuicao da % de sdev por
# res &lt;- dev.off() # reset plot parameters
hist(props, breaks = 100, col=&quot;Red&quot;)</code></pre>
<p><img src="/post/2018-01-24-knn-analysis-on-mnist-with-97-accuracy_files/figure-html/varianceDistribution-1.png" width="672" /></p>
</div>
<div id="cumulative-variance" class="section level3">
<h3>Cumulative Variance</h3>
<p>Let’s see how much dimension of the PCA we need to consider.</p>
<pre class="r"><code># ploting the cumulative variance
data_frame(x=1:length(pca$sdev), sdev.cum=cumsum(props)) %&gt;%
  ggplot(aes(x=x, y=sdev.cum)) +
  geom_line(color=&quot;darkblue&quot;, size=.8) +
  theme_minimal()</code></pre>
<p><img src="/post/2018-01-24-knn-analysis-on-mnist-with-97-accuracy_files/figure-html/cumulativeVar-1.png" width="672" /></p>
<p>You can see in the chart above, we can get 90% of variance with only 80 of dimension from a universe of 719! This is a great information compression, almost 10:1!</p>
</div>
</div>
<div id="ploting-cases-in-new-pca-space" class="section level2">
<h2>Ploting cases in new PCA space</h2>
<p>Lets see how the 200 first cases in the data set are distributed in the first two dimensions (15% the variation).</p>
<pre class="r"><code># lets see the distribution
pca.idx &lt;- sample(1:mnist$train$n, 200)
cases &lt;- tibble(
  label = as.factor(mnist$train$y[pca.idx]),
  x = tr.x[pca.idx,1],
  y = tr.x[pca.idx,2],
  z = tr.x[pca.idx,3]
)

# all cases
cases %&gt;%
  ggplot(aes(x=x, y=y, color=label)) +
  geom_point(size=2, alpha=.5) +
  theme_minimal()</code></pre>
<p><img src="/post/2018-01-24-knn-analysis-on-mnist-with-97-accuracy_files/figure-html/casesDistribution-1.png" width="672" /></p>
<p>A little mess, but if we plot only the most distances centroids (<code>0</code>, <code>1</code> e <code>9</code>) we already see a separable structures if only two dimensions.</p>
<pre class="r"><code># cases more &quot;distant&quot;
cases %&gt;%
  filter(label %in% c(&quot;0&quot;, &quot;1&quot;, &quot;9&quot;)) %&gt;%
  ggplot(aes(x=x, y=y, color=label)) +
  geom_point(size=2, alpha=.5) +
  theme_minimal()</code></pre>
<p><img src="/post/2018-01-24-knn-analysis-on-mnist-with-97-accuracy_files/figure-html/separableCases-1.png" width="672" /></p>
<p>This sound promising. An kNN approach with higher dimension may do a decent job classifying the digits. Lets put another one, increasing the <em>explained variation</em> to 23%.</p>
<div id="htmlwidget-1" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"visdat":{"25744654493f":["function () ","plotlyVisDat"]},"cur_data":"25744654493f","attrs":{"25744654493f":{"x":{},"y":{},"z":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","size":1,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"x"},"yaxis":{"title":"y"},"zaxis":{"title":"z"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[-906.937561228605,-454.90199152107,-565.967739414572,-1256.23841692441,-1617.53688482392,-1715.9166971004,-175.893182444392,-397.707043995178,-270.999032541974,-463.006091975479,-503.234109194231,-1728.09692200602,-628.252217363273,-842.662528891006,-1524.79163745575,-770.959464424454,-356.227993363563,-1243.00760658615,-1418.81166520164,-1210.89528921572,-2124.87224979677,-552.436116311431,-1696.65511215841,-561.686495074573,-582.232926521385],"y":[227.76326666207,-268.509305634358,167.686640130741,171.899281527205,167.460444088768,436.33180873664,-186.122191575107,145.91178011728,429.66361714916,40.4127987997125,49.8909128247135,-183.709471599656,256.696222701935,-185.649796915247,239.101940239889,95.6706907706904,-520.858586938553,267.986760949447,465.159010598263,249.197032495781,454.025247576556,-161.955887597233,298.909563257658,118.631277495678,595.158691536494],"z":[-300.991914460469,-167.967300459172,804.236618446716,-1082.0455778403,419.587809702406,-67.8117149702065,342.035234794925,-101.326777874621,431.520248426181,-117.4571250509,-498.754609452794,428.107044504356,246.18391299461,403.703987305063,-471.844015419206,304.070074589202,-812.006798275947,377.527237091998,-421.154513162383,390.659962785695,-234.570580829017,-60.4179438292807,599.784548676952,335.503708707536,625.487408545559],"type":"scatter3d","mode":"markers","name":"0","marker":{"color":"rgba(102,194,165,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)","size":55},"error_y":{"color":"rgba(102,194,165,1)","width":55},"error_x":{"color":"rgba(102,194,165,1)","width":55},"line":{"color":"rgba(102,194,165,1)","width":55},"frame":null},{"x":[868.538934483605,951.672075102337,805.015761242971,862.339103646062,259.696575175922,855.822391214321,926.870019226226,838.508535745723,976.091225821036,1035.36239908104,502.783947697109,925.867574372571,875.208199942549,979.356914725458,546.360853746247,825.03007190482,779.703574380775],"y":[729.227874746043,587.842672695822,734.182859613667,510.676495187491,759.681026344837,448.992633537568,676.182852267885,317.550847289071,456.221487878364,487.994839936815,917.101571394489,499.516217936494,472.658275671916,187.286234113653,365.341923585461,259.407955996807,874.354040384936],"z":[-200.810085390694,-216.878998313344,-309.845599841478,-15.4820629015983,136.853933352578,-166.872184177906,-193.300290038801,-0.467827453051689,-141.542109434555,-86.0931809474288,-675.524265487784,-50.8048856644874,-176.278388918369,53.7294724403526,72.5157694235715,19.3990477273047,-408.39173979042],"type":"scatter3d","mode":"markers","name":"1","marker":{"color":"rgba(228,156,113,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(228,156,113,1)"}},"textfont":{"color":"rgba(228,156,113,1)","size":55},"error_y":{"color":"rgba(228,156,113,1)","width":55},"error_x":{"color":"rgba(228,156,113,1)","width":55},"line":{"color":"rgba(228,156,113,1)","width":55},"frame":null},{"x":[7.52996826107826,-215.571094505786,-163.864021997874,-89.0555540403452,-402.303160074212,196.099267673064,316.846849048942,-283.629192415148,74.6014557169367,-701.799071309504,-31.5484177543198,-412.345281517935,-811.258682873965,288.115326398944,523.038986102239,-186.562133122556,25.9552571593027,-189.203923515728,-413.686508607414,-109.904875665232,-274.635517031522],"y":[409.4954258138,139.390133372374,-53.7427406974636,156.992166021639,1158.61690497591,1053.75897763937,20.2933951237695,-2.097221612182,358.491594348006,-160.685708858443,-199.817584856177,232.898960897336,353.128400746611,-316.269138957644,685.161619283405,454.990156953389,682.206856879889,900.695449757528,439.94190093674,351.165369467651,553.518246178341],"z":[-40.557266359149,-396.318742209351,-338.887432151761,-383.599312482428,-252.348624551729,332.802144395905,166.179681510509,-453.630819910404,-362.509984277568,-593.325240436359,-545.589930087241,-322.116746995953,-179.730963224942,-70.7096501060347,-108.283614491752,-129.908376500515,-169.382371184737,-565.488850180909,-105.723794806813,-418.578658286528,-467.592447123303],"type":"scatter3d","mode":"markers","name":"2","marker":{"color":"rgba(201,153,157,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(201,153,157,1)"}},"textfont":{"color":"rgba(201,153,157,1)","size":55},"error_y":{"color":"rgba(201,153,157,1)","width":55},"error_x":{"color":"rgba(201,153,157,1)","width":55},"line":{"color":"rgba(201,153,157,1)","width":55},"frame":null},{"x":[114.403877483372,-41.1156058724647,317.969947553341,494.991914576403,149.182156200788,-248.292977808782,238.310824875627,-268.245495831602,12.6179428890596,-232.830739725875,-814.375631811209,-26.1138991131631,456.116302737307,-168.704649189969,-88.0951741144875,207.627409956098,-161.193186658968,-222.493559629967,100.995368326713],"y":[129.467907009603,602.154340968032,228.065458844569,108.252255123572,512.287535698822,270.117673529851,461.895253446584,-58.2649998466269,685.630075766351,398.261526178905,452.00036978358,827.065632939694,608.754682056026,1009.54944635836,399.021804704409,387.638198727713,621.299900067024,621.754054087598,794.2558411111],"z":[733.549460580701,1128.71297186268,1047.85262809508,752.968452558423,743.143884619798,1110.35679532517,1058.91093154937,1064.86665558438,439.085895397071,600.521899081273,534.908565809468,-431.173321119332,312.78986010411,484.459730027915,59.2928277808558,24.3971356770077,533.540786871174,394.15435580393,759.761977916189],"type":"scatter3d","mode":"markers","name":"3","marker":{"color":"rgba(175,154,200,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(175,154,200,1)"}},"textfont":{"color":"rgba(175,154,200,1)","size":55},"error_y":{"color":"rgba(175,154,200,1)","width":55},"error_x":{"color":"rgba(175,154,200,1)","width":55},"line":{"color":"rgba(175,154,200,1)","width":55},"frame":null},{"x":[-85.8967701181968,-314.140656406712,477.777404018062,349.712631011554,55.4724821192575,-9.6137342059098,452.432666524292,-246.008826080339,-80.5749723267931,212.494686901053,265.506178031009,322.038333162068,578.115646639926,145.665559605557,51.6435393723101],"y":[-943.335579843486,-1046.15508199323,-289.587027872135,241.517683088007,-548.968153737834,-497.185672973742,-520.86004794725,-764.939152254311,-694.912138579757,-342.764439215085,-299.483716229287,-734.505867289574,-264.769136078595,-715.624273053408,-448.016560340752],"z":[-739.185802100826,386.046269612684,-225.45455289455,-215.967916030639,242.906754748539,145.698440855794,265.096497812393,526.979181958369,-236.312540824025,71.3515979687547,-154.718120300294,-194.92722475433,414.217484654944,527.181691690108,548.852060012307],"type":"scatter3d","mode":"markers","name":"4","marker":{"color":"rgba(226,148,184,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(226,148,184,1)"}},"textfont":{"color":"rgba(226,148,184,1)","size":55},"error_y":{"color":"rgba(226,148,184,1)","width":55},"error_x":{"color":"rgba(226,148,184,1)","width":55},"line":{"color":"rgba(226,148,184,1)","width":55},"frame":null},{"x":[-284.168640112935,232.603062041377,-611.837393212608,-164.229362671219,-789.464268216499,-777.429078874389,-265.231651405167,522.567508247753,-441.063474859099,-275.786540354062,35.0576214767655,54.0779569765772,-421.520361456928,13.1712200998939,-55.4463342872367,200.298104186778,-610.693551609428,350.651999517224,-140.033956796536,-1318.39937488849,-165.572795242251,-194.212382142758,-330.291584974143,-671.184042137025,-398.312234745547],"y":[44.5075639255371,539.493497223342,375.50006386721,269.379391715427,848.505069864714,471.088767838317,-34.6332495353778,150.915215833181,456.392313003872,398.777474607983,136.353028567328,59.4345433586382,477.140267341964,-42.987196944163,116.025659623997,317.045296161369,391.441975075483,-37.3733183650123,120.242282246534,635.861485560244,431.48120308752,689.649805328415,252.655180065252,248.594505509718,9.05649380544984],"z":[460.672088006207,-427.446105426559,-489.892177964477,-499.33695745806,597.855859513751,701.204418742435,-722.777350368125,-481.642955302528,457.718641752595,1091.46384966253,895.123375274601,620.1230517635,638.32553729355,422.457504568441,366.435568488085,354.040242281754,721.572021823119,-513.359850160144,777.805457033859,593.263567842225,876.519171485754,-322.515321162337,993.227639085144,204.801125547133,32.9696127839791],"type":"scatter3d","mode":"markers","name":"5","marker":{"color":"rgba(176,209,99,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(176,209,99,1)"}},"textfont":{"color":"rgba(176,209,99,1)","size":55},"error_y":{"color":"rgba(176,209,99,1)","width":55},"error_x":{"color":"rgba(176,209,99,1)","width":55},"line":{"color":"rgba(176,209,99,1)","width":55},"frame":null},{"x":[368.404835383352,-828.214933679042,142.742048423802,14.7980437240473,-275.809675334767,-120.056361426305,-611.128502118583,-341.798534410768,8.84716362457176,37.5763338130208,-259.51651202051,69.1543960274383,-154.037807433624,-345.509705557953,-394.89359289565,209.120533338547,-645.382173026666,326.272103667058,-806.449213193205,-105.013114677229,-234.425913642708,-343.925231716767,-475.124848153048,-663.588184964348,503.067311196187],"y":[66.2027587497305,64.2284633009886,58.7830608950102,287.307772063348,247.499812257266,-479.742098805405,0.187329827467392,242.603499559278,527.048428155582,-73.927501679721,-79.961899893973,11.015056373659,-307.069178725719,-624.131296407109,78.5036449187962,-125.875527133254,107.868194826316,354.28538772494,-523.654692891175,142.343716835234,-106.15281071677,-28.2124816287934,73.7478408259336,-231.442615924489,342.967067368246],"z":[-796.752072657904,-174.787848170205,-517.100193282578,-378.054779724213,-788.151465234195,25.5237021540604,323.200920206787,-665.516882034171,-311.190198180101,-190.21226940309,-569.0777843554,-223.864275079825,-356.970385211883,-150.073799431139,31.2986710262485,-116.980709528302,-941.521233715958,-149.077997404424,-341.601766457334,-108.932209426327,-191.752009817906,-756.818791227109,-640.37850521319,-3.91468704228914,-120.261195569174],"type":"scatter3d","mode":"markers","name":"6","marker":{"color":"rgba(227,217,62,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(227,217,62,1)"}},"textfont":{"color":"rgba(227,217,62,1)","size":55},"error_y":{"color":"rgba(227,217,62,1)","width":55},"error_x":{"color":"rgba(227,217,62,1)","width":55},"line":{"color":"rgba(227,217,62,1)","width":55},"frame":null},{"x":[-249.777360881103,133.877171453851,173.409043580415,-350.072600757289,418.881337129564,307.47564085892,249.309648421338,-128.365089594758,249.507257342367,-353.410159467798,862.36623707998,691.456974026593,773.294473659637,482.371167950678,183.998192701449,258.251705793715,42.5581774263697,61.4652977741248,-584.860839021762],"y":[-1118.65166863103,-667.265751298818,31.2182320816165,-765.512957042328,-557.804626138393,-911.417479063957,-745.370599748544,-755.730077133609,-780.008537200188,-358.781082038674,-9.68496792833023,-278.52469544166,9.48638132835423,-356.151769975406,-205.338400065786,-752.682892223867,-599.474315203035,-769.728726472318,-925.04774589996],"z":[-348.732187434796,-373.640525241455,-371.353858215399,19.6155014553468,-353.782358340815,359.339056367165,408.629390757282,2.93762878194815,617.309929149082,-630.945046806673,120.554011815479,-51.1412489227624,273.933652308433,-199.545234201931,-534.726998715339,689.334510987307,151.573058228694,-380.255927424308,726.333977314563],"type":"scatter3d","mode":"markers","name":"7","marker":{"color":"rgba(245,207,100,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(245,207,100,1)"}},"textfont":{"color":"rgba(245,207,100,1)","size":55},"error_y":{"color":"rgba(245,207,100,1)","width":55},"error_x":{"color":"rgba(245,207,100,1)","width":55},"line":{"color":"rgba(245,207,100,1)","width":55},"frame":null},{"x":[111.616676994862,300.962342960126,103.290707705348,-7.60612675860554,-4.50556281367757,-17.9523741651687,-383.7749489644,371.271385589718,295.430377933625,-654.389301720614,53.5619157043921,-36.7491314011338,478.334567568655,-5.40780283827193,-642.3176485099,197.537572850104,518.082884743002,-209.587183677031,507.593968427144,384.220312708216,303.566187033518,-487.916379253332],"y":[440.188079023863,363.491879939006,47.9847973275364,147.35955045273,550.296188796413,243.380553199652,337.776828747511,367.920478741705,602.948423471926,215.629413752641,-161.970337156062,-214.773968023327,-56.9450473586311,316.044573018823,-80.677986606175,-142.461933465286,122.883970776384,-408.572341706357,672.594618504994,360.607277635333,479.933943540578,-30.9973603023384],"z":[-548.835502599606,-1.82893554684472,-508.148997777449,-310.881036698382,513.874026458176,-119.631058289793,127.958907841421,451.225446308648,-662.238539740195,99.2367549388586,328.658792735754,72.8982902954507,-287.404916836285,272.004241712647,722.559717152032,426.112152930788,567.329351106311,338.859585294775,-210.080793434177,-589.190809902008,-496.154680576733,-162.744198127499],"type":"scatter3d","mode":"markers","name":"8","marker":{"color":"rgba(219,192,155,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(219,192,155,1)"}},"textfont":{"color":"rgba(219,192,155,1)","size":55},"error_y":{"color":"rgba(219,192,155,1)","width":55},"error_x":{"color":"rgba(219,192,155,1)","width":55},"line":{"color":"rgba(219,192,155,1)","width":55},"frame":null},{"x":[402.445766941775,797.720421094092,27.1900099435902,182.067871397042,212.417917278258,212.132041131094,-152.805553241884,702.290450727822,864.922419330984,900.716222859126,129.52055260651,-182.40472376122],"y":[-416.795491208841,-132.795765625785,-833.076808301754,-424.335413790506,-382.621481904911,-570.916576458198,-572.052127343812,-203.28841292284,-31.7265395146395,94.7027085325596,-856.623254922867,-733.114281161684],"z":[-580.714152838608,-65.5346486036418,551.315141417496,592.519167398838,988.895809156268,619.194879710568,423.538297507511,-120.107701826905,188.19645493912,-145.854554152167,-405.513265381611,-17.7889151165844],"type":"scatter3d","mode":"markers","name":"9","marker":{"color":"rgba(179,179,179,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(179,179,179,1)"}},"textfont":{"color":"rgba(179,179,179,1)","size":55},"error_y":{"color":"rgba(179,179,179,1)","width":55},"error_x":{"color":"rgba(179,179,179,1)","width":55},"line":{"color":"rgba(179,179,179,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>You can play around turning off the cases of some digits and rotating the chart. Can you see how the <code>0</code>, <code>1</code> and <code>9</code> clusters are distributed in the space? And the <code>4</code> and <code>9</code> cases?</p>
<!-- knn-mnist-ad03 -->
<ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-5624634479725935" data-ad-slot="7308282255" data-ad-format="auto" data-full-width-responsive="true">
</ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<div id="k-nearest-neighbors" class="section level2">
<h2>k-Nearest Neighbors</h2>
<p>We saw that the PCA did a great job spreading the digits in the space, allow some separation, now let’s apply a kNN fit on this. We need to decide the number of dimension to be used (<code>n</code>) and the number of k-Nearest (<code>k</code>), to do this let’s make a cross validation search<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>.</p>
<pre class="r"><code># knn cross validation
part.idx &lt;- sample(1:mnist$train$n, round(mnist$train$n/2))

# cross validation parameters
k &lt;- seq(2,14, 2)
n &lt;- seq(5,80,10)
cross.params &lt;- crossing(k=k, n=n)</code></pre>
<pre class="r"><code># fit a kNN Model for each cross validation pair, and calc the accuracy
result &lt;- apply(X = cross.params,1, function(p, tr.idx = part.idx, x=tr.x, y=as.factor(mnist$train$y)){
  k_par &lt;- as.integer(p[1])
  n_par &lt;- as.integer(p[2])
  
  print(paste0(&quot;fitting: k=&quot;,k_par, &quot; n=&quot;,n_par))

  y_hat &lt;- knn(
    train = x[tr.idx,1:n_par], 
    test=x[-tr.idx,1:n_par], 
    cl=y[tr.idx],
    k=k_par
  )
  
  accuracy &lt;- mean(y[-tr.idx]==y_hat)
  print(paste0(&quot;Accuracy: &quot;, round(accuracy,4)))
  return(accuracy)
  
})

# build the CV results
cv.results &lt;- bind_cols(cross.params, accuracy=result)
saveRDS(cv.results, &quot;cv_result.rds&quot;) # to save time
str(cv.results)</code></pre>
<p>The result is a data frame contain a pair of <code>k</code> and <code>n</code>and the <code>accuracy</code> that the kNN classifier get from this configuration</p>
<pre><code>## Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:    56 obs. of  3 variables:
##  $ k       : num  2 2 2 2 2 2 2 2 4 4 ...
##  $ n       : num  5 15 25 35 45 55 65 75 5 15 ...
##  $ accuracy: num  0.681 0.943 0.962 0.966 0.966 ...</code></pre>
<p>Let’s see the <em>accuracy surface</em> defined by <code>k</code> and <code>n</code> parameters.</p>
<pre class="r"><code># ploting the error &quot;surface&quot;
cv.results %&gt;%
  wireframe(accuracy~n*k, .)</code></pre>
<p><img src="/post/2018-01-24-knn-analysis-on-mnist-with-97-accuracy_files/figure-html/plotAccuracySurface-1.png" width="672" /></p>
<pre class="r"><code># which pair k and n are better ?
best &lt;- cv.results[which(cv.results$accuracy==max(cv.results$accuracy)),]</code></pre>
<p>The best result was k=4 and n=35, with an accuracy of 97%. Not so bad, comparing the 99% accuracy of LeNet ANN from the <a href="/2018/01/implementing-lenet-with-mxnet-in-r/">last post</a>.</p>
</div>
<div id="conclusion" class="section level2">
<h2>Conclusion</h2>
<p>As we see, the data analysis on the MNIST data set allow us to realize that the digit recognition problem can be solved, with great accuracy, by a simple kNN model. Of course this is not a complete image recognition problem, an ANN would learn to separate the classes without our intervention.</p>
<p>But the analysis show that, in this case, we don’t need jump directly to an expensive ANN, and better than that, it indicates that not all 784 pixels are necessary do identify a digit and we can, for sure, use the kNN´s pre-classification as another input for the ANN, or fit independent ANNs for difficult cases like <code>4</code>x<code>9</code>, showing another paths for model improvement.</p>
<div id="references" class="section level3">
<h3>References</h3>
<p>This post was inspired by:</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p><a href="http://varianceexplained.org/r/digit-eda/" class="uri">http://varianceexplained.org/r/digit-eda/</a><a href="#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p><a href="https://steven.codes/blog/ml/how-to-get-97-percent-on-MNIST-with-KNN/" class="uri">https://steven.codes/blog/ml/how-to-get-97-percent-on-MNIST-with-KNN/</a><a href="#fnref2" class="footnote-back">↩</a></p></li>
</ol>
</div>

              
            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="/tags/en-us/">en-US</a>

  <a class="tag tag--primary tag--small" href="/tags/evalutation/">evalutation</a>

  <a class="tag tag--primary tag--small" href="/tags/knn/">knn</a>

  <a class="tag tag--primary tag--small" href="/tags/machine-learning/">machine learning</a>

  <a class="tag tag--primary tag--small" href="/tags/mnist/">mnist</a>

  <a class="tag tag--primary tag--small" href="/tags/pca/">pca</a>

                  </div>
                
              
            
            <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="/2018/02/data-science-das-cervejas-1-2/" data-tooltip="Data Science das Cervejas (1/2)">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="/2018/01/implementing-lenet-with-mxnet-in-r/" data-tooltip="Implementing LeNet with MXNET in R">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=/2018/01/knn-analysis-on-mnist-with-97-accuracy/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=/2018/01/knn-analysis-on-mnist-with-97-accuracy/">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=/2018/01/knn-analysis-on-mnist-with-97-accuracy/">
              <i class="fa fa-google-plus"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

            
              
                <div id="disqus_thread">
  <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
              
            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2021 Giuliano Sposito. All Rights Reserved
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
        <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="/2018/02/data-science-das-cervejas-1-2/" data-tooltip="Data Science das Cervejas (1/2)">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="/2018/01/implementing-lenet-with-mxnet-in-r/" data-tooltip="Implementing LeNet with MXNET in R">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=/2018/01/knn-analysis-on-mnist-with-97-accuracy/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=/2018/01/knn-analysis-on-mnist-with-97-accuracy/">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=/2018/01/knn-analysis-on-mnist-with-97-accuracy/">
              <i class="fa fa-google-plus"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

      </div>
      <div id="share-options-bar" class="share-options-bar" data-behavior="5">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=%2F2018%2F01%2Fknn-analysis-on-mnist-with-97-accuracy%2F">
          <i class="fa fa-facebook-official"></i><span>Share on Facebook</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=%2F2018%2F01%2Fknn-analysis-on-mnist-with-97-accuracy%2F">
          <i class="fa fa-twitter"></i><span>Share on Twitter</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=%2F2018%2F01%2Fknn-analysis-on-mnist-with-97-accuracy%2F">
          <i class="fa fa-google-plus"></i><span>Share on Google&#43;</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="https://www.gravatar.com/avatar/2adfb1930aa9591ea756b0d94ca3603b?s=110" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Giuliano Sposito</h4>
    
      <div id="about-card-bio">Computer Engineer<!-- raw HTML omitted -->Masters in Tech Innovation Mgt<!-- raw HTML omitted -->Specialized in Data Science</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Senior Manager<!-- raw HTML omitted --><a href="http://www.ciandt.com">CI&amp;T</a>
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        Brazil
      </div>
    
  </div>
</div>

    

    
  
    
      
      <div id="cover" style="background-image:url('/images/new_cover_emboss.jpg');"></div>
    
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js" integrity="sha256-GEAnjcTqVP+vBp3SSc8bEDQqvWAZMiHyUSIorrWwH50=" crossorigin="anonymous"></script>


<script src="/js/script-pcw6v3xilnxydl1vddzazdverrnn9ctynvnxgwho987mfyqkuylcb1nlt.min.js"></script>


<script lang="javascript">
window.onload = updateMinWidth;
window.onresize = updateMinWidth;
document.getElementById("sidebar").addEventListener("transitionend", updateMinWidth);
function updateMinWidth() {
  var sidebar = document.getElementById("sidebar");
  var main = document.getElementById("main");
  main.style.minWidth = "";
  var w1 = getComputedStyle(main).getPropertyValue("min-width");
  var w2 = getComputedStyle(sidebar).getPropertyValue("width");
  var w3 = getComputedStyle(sidebar).getPropertyValue("left");
  main.style.minWidth = `calc(${w1} - ${w2} - ${w3})`;
}
</script>

<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight > code, pre > code').each(function(i, block) {
    if (!$(this).hasClass('codeblock')) {
      $(this).addClass('codeblock');
    }
    hljs.highlightBlock(block);
  });
});
</script>


  
    
      <script>
        var disqus_config = function () {
          this.page.url = '\/2018\/01\/knn-analysis-on-mnist-with-97-accuracy\/';
          
            this.page.identifier = '\/2018\/01\/knn-analysis-on-mnist-with-97-accuracy\/'
          
        };
        (function() {
          
          
          if (window.location.hostname == "localhost") {
            return;
          }
          var d = document, s = d.createElement('script');
          var disqus_shortname = 'yet-another-iteration';
          s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
      </script>
    
  




    
  </body>
</html>

